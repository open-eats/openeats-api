sudo: required

language: python

python:
  - "3.6"

services:
  - docker

before_install:
- docker-compose -f test.yml -p test build
- docker-compose -f test.yml -p test up -d db
# We are adding a sleep here so that the db has enough time to come online
- sleep 90

script:
- docker-compose -f test.yml -p test run --rm \
  --entrypoint 'sh tests.sh' \
  -e TRAVIS_JOB_ID=$TRAVIS_JOB_ID \
  -e TRAVIS_BRANCH=$TRAVIS_BRANCH \
  -e TRAVIS=$TRAVIS \
  -e CC_TEST_REPORTER_ID=787a2f89b15c637323c7340d65ec17e898ac44480706b4b4122ea040c2a88f1d \
  api
